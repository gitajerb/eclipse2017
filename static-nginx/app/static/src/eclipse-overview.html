<!--
Copyright 2016 Google Inc.
Licensed under the Apache License, Version 2.0 (the "License");

you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
-->

<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/google-youtube/google-youtube.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../bower_components/marked-element/marked-element.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-card/paper-card.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/paper-styles/color.html">
<link rel="import" href="../bower_components/paper-styles/shadow.html">
<link rel="import" href="../bower_components/marked-element/marked-element.html">
<link rel="import" href="eclipse-scroll-button/eclipse-scroll-button.html">
<link rel="import" href="eclipse-section/eclipse-section.html">
<link rel="import" href="eclipse-text-box/eclipse-text-box.html">
<link rel="import" href="shared-styles.html">
<script src="movie-id.js"></script>

<dom-module id="eclipse-overview">
  <template>
    <style include="shared-styles">
      :host {
        display: block;
        width:100%;
      }

      .about h2 {
        @apply(--paper-font-display1);
      }

      .about {
        @apply(--layout-vertical);
        @apply(--layout-center);
        @apply(--layout-center-justified);
        background-color: #4881f4;
        min-height: 65vh;
      }

      .cards {
        @apply(--layout-vertical);
      }

      @media all and (min-width:600px) {
        .cards {
          @apply(--layout-horizontal);
        }
      }

      .cards a {
        display: flex;
      }

      paper-card:hover {
        @apply(--shadow-elevation-16dp);
        position:relative;
        top: -2px;
      }

      paper-card {
        @apply(--card);
        @apply(--layout-flex-auto);
      }
      paper-card .card-image-holder {
        @apply(--layout-horizontal);
        @apply(--layout-center-justified);
        padding: 16px 0;
      }
      paper-card .text {
        @apply(--paper-font-body1);

      }
      paper-card .title {
        @apply(--paper-font-subhead);
        color: var(--paper-blue-500);
        display:block;
        text-align:center;
        text-decoration:none;
      }

      #joingroup {
        background-color: #f8e71c;
      }

      .attribution a:hover,
      .partner-list a:hover {
        text-decoration: underline;
      }

      a paper-button,
      a:active paper-button,
      a:visited paper-button {
        color: var(--paper-grey-800);
        text-decoration:none;
      }

      a {
        text-decoration: none;
        color: var(--paper-yellow-500);
      }

      a.learnmore {
        margin-left: 24px;
        margin-right: 24px;
        color: #fff;
      }

      a.learnmore paper-button {
        color: #fff;
      }

      .partner-list {
        @apply(--layout-vertical);
        @apply(--layout-center-justified);
        text-align:center;
        margin:24px 0;
      }

      .partner-list a {
        color: var(--paper-yellow-500);
        display: block;
        margin: 4px 8px;
      }

      .image-holder {
        text-align:center;
      }

      @media all and (min-width:600px) {
        .image-holder {
          max-width:calc(100% - 500px);
        }

        .video-description {
          max-width: 350px;
        }
      }

      .image-holder img {
        width: 100%;
      }

      .attribution {
        @apply(--paper-font-caption);
      }

      .video-holder {
        position:relative;
        background:#000;
        display:flex;
        width:100%;
        @apply(--layout-horizontal);
        @apply(--layout-center-justified);
      }

      .video-overlay {
        position:absolute;
        z-index: 1;
        text-shadow: 3px 3px #000000;
        text-align:center;
        left:0;
        right:0;
        top:0;
        bottom:0;
        @apply(--layout-vertical);
        @apply(--layout-center-justified);
        @apply(--layout-center);
        pointer-events: none;
      }

      .video-overlay h2 {
        @apply(--paper-font-display1);
        max-width: 450px;
      }

      .video-overlay p {
        max-width: 450px;
      }

      .video-holder[nonfluid] {
        min-height: 60vh;
        @apply(--layout-center);
        @apply(--layout-wrap);
      }

      .video-description {
        @apply(--paper-font-body1);
        margin: 32px;
      }

      .video-description h2 {
        @apply(--paper-font-display1);
      }
    </style>
    <app-location id="urlbar" route="{{route}}" query-params="{{queryParams}}"></app-location>
    <!-- Home page content -->
    <div id="main">

      <div class="video-holder" nonfluid>
        <google-youtube
            name="hero"
            video-id="[[movieId]]"
            controls="1"
            modestbranding="1"
            showinfo="0"
            iv_load_policy="3"
            rel="0"
            state="{{state}}"
        ></google-youtube>
        <div class="video-description">
          <h2>Megamovie 2017</h2>
          <p>This first-of-its-kind citizen science project is a collection of photos submitted by a group of dedicated volunteers from locations across the United States during the August 21, 2017 total solar eclipse. These individual photos have been stitched together to give us an extended look at the sun’s atmosphere as the eclipse traversed the US.</p>
          <p>This is but a preview of what can be made with these data. This video was compiled algorithmically, but future versions can be compiled with additional hands-on editing to improve the outcome. To see the latest from the project, check out the full dataset of images on <a href="https://console.cloud.google.com/launcher/details/google-cloud-public-datasets/eclipse-megamovie" target="_blank">Google Cloud Open Datasets</a> and help the scientists categorize our images in <a href="https://www.zooniverse.org/projects/robertlet/megamovie-maestros-i" target="_blank">Megamovie Maestros I</a>. We are excited to see what improved movies and scientific discoveries come from the dataset in the years to come.</p>
        </div>
      </div>

      <!-- Follow along could go here. -->

      <div class="about">
        <h2>About Us</h2>
        <div class="cards">
          <a href="https://makingscience.withgoogle.com" target="_blank">
            <paper-card elevation="2">
              <div class="card-image-holder"><img src="{{cardGoogle.image}}" /></div>
              <div class="title">[[cardGoogle.title]]</div>
              <marked-element class="text" markdown="{{cardGoogle.body}}">
                <div class="markdown-html"></div>
              </marked-element>
            </paper-card>
          </a>
          <a href="http://multiverse.ssl.berkeley.edu/" target="_blank">
            <paper-card elevation="2">
              <div class="card-image-holder"><img src="{{cardBerkeley.image}}" /></div>
              <div class="title">[[cardBerkeley.title]]</div>
              <marked-element class="text" markdown="{{cardBerkeley.body}}">
                <div class="markdown-html"></div>
              </marked-element>
            </paper-card>
          </a>
        </div>
        <div class="partner-list">
          <h2>Partners</h2>
          <template is="dom-repeat" items="[[partnerList]]">
            <a href="[[item.url]]" target="_blank">[[item.title]]</a>
          </template>
        </div>
      </div>
    </div>
  </template>

  <script>
    Polymer({
      is: 'eclipse-overview',

      behaviors: [],

      properties: {
        cardGoogle: {
          type: Object,
          value: {
            image: "/images/collaborator1_Google.png",
            title: "Making & Science Team",
            body: "We’re the Making & Science team and we work to support programs that inspire interest in science and making. Many of the Google products used by millions of people around the world exist because makers, scientists, and engineers wanted to create projects to improve our world. If you want to join in, we are here for you."
          }
        },
        cardBerkeley: {
          type: Object,
          value: {
            image: "/images/collaborator2_Berkeley.png",
            title: "Multiverse Team",
            body: "The Multiverse team headquartered at UC Berkeley’s Space Sciences Laboratory makes Earth and space science accessible through transformative educational experiences and vetted resources. Ultimately, we seek to connect with people’s sense of wonder and increase their personal ties to science."
          }
        },
        isSignedIn: {
          type: Boolean
        },
        partnerList: {
          type: Array
        },

        movieId: {
          type: String,
          value: movie_id // comes from movie-id.js
        }
      },

      ready: function() {
        this.partnerList = [
          {
            "title" : "Astronomical Society of the Pacific",
            "url" : "https://www.astrosociety.org/"
          },
          {
            "title" : "Center for Research on Lifelong STEM Learning, Oregon State University",
            "url" : "http://stem.oregonstate.edu/"
          },
          {
            "title" : "Eclipse Across America",
            "url" : "http://www.eclipseacrossamerica.org/"
          },
          {
            "title" : "Foothill College",
            "url": "https://www.foothill.edu/ast/fraknoi.php"
          },
          {
            "title" : "High Altitude Observatory of the National Center for Atmospheric Research",
            "url" : "https://www2.hao.ucar.edu/"
          },
          {
            "title" : "Ideum",
            "url" : "https://www.ideum.com/"
          },
          {
            "title" : "Lick Observatory",
            "url" : "https://www.ucolick.org/"
          },
          {
            "title" : "Sonoma State University",
            "url" : "http://epo.sonoma.edu/"
          },
          {
            "title" : "Space Sciences Laboratory, University of California, Berkeley",
            "url" : "http://www.ssl.berkeley.edu/"
          },
          {
            "title" : "University of Colorado at Boulder",
            "url" : "http://cires.colorado.edu/"
          },
          {
            "title" : "Williams College and the IAU Working Group",
            "url" : "http://sites.williams.edu/iau-eclipses/"
          }
        ];
      },

      deselected: function() {
        this._pauseHeroIfPlaying();
      },

      _shouldShowVideoOverlay: function(state) {
        return state == -1 || state == 0;
      },

      _pauseHeroIfPlaying: function() {
        var video = this.$$("google-youtube[name=hero]");
        if (video && video.state == 1) {
          video.pause();
        }
      },

      _showPromoVideo: function(eclipseState) {
        return eclipseState == this.PRE_ECLIPSE_DAY;
      }
    });
  </script>
</dom-module>
